# üöÄ –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ Internet Monitor (v2 Speed-Only)

> **–í–µ—Ä—Å–∏—è 2.0:** –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –∏ –Ω–∞–¥–µ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞. –¢–æ–ª—å–∫–æ —Ç–µ—Å—Ç—ã —Å–∫–æ—Ä–æ—Å—Ç–∏. –ù–∏–∫–∞–∫–∏—Ö –ª–∏—à–Ω–∏—Ö –ø–∏–Ω–≥–æ–≤.

## –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ VPS –°–µ—Ä–≤–µ—Ä–∞

1.  **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É:**
    ```bash
    ssh root@YOUR_SERVER_IP
    ```

2.  **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Node.js (–µ—Å–ª–∏ –Ω–µ—Ç):**
    ```bash
    curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
    sudo apt-get install -y nodejs
    ```

3.  **–°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞:**
    ```bash
    mkdir -p /root/internet-monitor-websocket
    cd /root/internet-monitor-websocket
    ```

4.  **–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª—ã —Å–µ—Ä–≤–µ—Ä–∞:**
    –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª—ã `server.js` –∏ `package.json` –∏–∑ –ø–∞–ø–∫–∏ `server_websocket` –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –≤ —ç—Ç—É –ø–∞–ø–∫—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.

5.  **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
    ```bash
    npm install express ws cors helmet dotenv
    npm install -g pm2
    ```

6.  **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
    –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –∏–ª–∏ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `server.js` –Ω–∞–ø—Ä—è–º—É—é (–º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∫–æ–¥–µ, —Ç–∞–∫ —á—Ç–æ `.env` –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω, –Ω–æ –∂–µ–ª–∞—Ç–µ–ª–µ–Ω).
    ```bash
    # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ:
    export N8N_WEBHOOK_URL="https://botstroikom.store"
    ```

7.  **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ PM2:**
    ```bash
    pm2 start server.js --name "internet-monitor-ws"
    pm2 save
    pm2 startup
    ```

## –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PWA –ö–ª–∏–µ–Ω—Ç–∞

1.  **–û—Ç–∫—Ä–æ–π—Ç–µ `pwa/app.js`:**
    –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `serverUrl` —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –≤–∞—à VPS:
    ```javascript
    serverUrl: 'wss://befiebubopal.beget.app/ws' // –ò–ª–∏ –≤–∞—à IP: ws://155.212.220.59:8081
    ```

2.  **–ó–∞–≥—Ä—É–∑–∏—Ç–µ –Ω–∞ GitHub Pages:**
    *   –ó–∞–∫–æ–º–º–∏—Ç—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø–∞–ø–∫–µ `pwa/`.
    *   –°–¥–µ–ª–∞–π—Ç–µ `git push`.
    *   –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è GitHub -> Pages -> Source: `main` / `root` (–∏–ª–∏ `docs` –µ—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –µ—ë).

3.  **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ:**
    *   –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.
    *   **–í–∞–∂–Ω–æ:** –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à –∏–ª–∏ —É–¥–∞–ª–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–Ω–æ–≤–æ, —á—Ç–æ–±—ã –ø–æ–¥—Ç—è–Ω—É–ª—Å—è –Ω–æ–≤—ã–π –∫–æ–¥.
    *   –í –ª–æ–≥–∞—Ö –≤—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å: `üöÄ App Version: Speed-Only v1.0`.

## –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ N8N

–°–æ–∑–¥–∞–π—Ç–µ Workflow —Å Webhook —Ç—Ä–∏–≥–≥–µ—Ä–æ–º:

1.  **Webhook Node:**
    *   Method: `GET`
    *   Path: `webhook/ph1` (–∏–ª–∏ —Ç–æ—Ç, —á—Ç–æ —É–∫–∞–∑–∞–Ω –≤ `server.js`)

2.  **Switch Node (–∏–ª–∏ If):**
    *   –£—Å–ª–æ–≤–∏–µ: `{{ $json.query.speedMbps }} > 0`

3.  **–í–µ—Ç–∫–∞ True (–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –µ—Å—Ç—å):**
    *   –ù–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º –∏–ª–∏ –ª–æ–≥–∏—Ä—É–µ–º —Å–∫–æ—Ä–æ—Å—Ç—å.

4.  **–í–µ—Ç–∫–∞ False (–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –ø—Ä–æ–ø–∞–ª):**
    *   –®–ª–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram: "‚ö†Ô∏è Internet Lost! Reason: {{ $json.query.reason }}"

## üõ†Ô∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –û—Ç–ª–∞–¥–∫–∞

**–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ —Å–µ—Ä–≤–µ—Ä–∞:**
```bash
ssh root@YOUR_SERVER_IP 'pm2 logs internet-monitor-ws --lines 50'
```

**–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ (–ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–¥–∞):**
```bash
ssh root@YOUR_SERVER_IP 'pm2 restart internet-monitor-ws'
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ PWA:**
–í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –µ—Å—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –ª–æ–≥.
*   ‚úÖ `Welcome...` ‚Äî —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –µ—Å—Ç—å.
*   üöÄ `–ó–∞–ø—Ä–æ—Å —Ç–µ—Å—Ç–∞...` ‚Äî —Å–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.
*   ‚úÖ `–°–∫–æ—Ä–æ—Å—Ç—å: 55.5 Mbps` ‚Äî —Ç–µ—Å—Ç –ø—Ä–æ—à–µ–ª.

