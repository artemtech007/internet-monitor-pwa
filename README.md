# üåê Internet Monitor Pro - Production Ready

**–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ —Å WebSocket –∏ PWA**

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   PWA Client    ‚îÇ    ‚îÇ  WebSocket      ‚îÇ    ‚îÇ      N8N        ‚îÇ
‚îÇ (GitHub Pages)  ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ   Server        ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ   Webhooks      ‚îÇ
‚îÇ artemtech007/   ‚îÇ    ‚îÇ (VPS/Node.js)  ‚îÇ    ‚îÇ                 ‚îÇ
‚îÇ internet-monitor‚îÇ    ‚îÇ 155.212.220.59 ‚îÇ    ‚îÇ ‚Ä¢ Analytics     ‚îÇ
‚îÇ -pwa            ‚îÇ    ‚îÇ                 ‚îÇ    ‚îÇ ‚Ä¢ Notifications ‚îÇ
‚îÇ ‚Ä¢ Speed tests   ‚îÇ    ‚îÇ ‚Ä¢ Device mgmt   ‚îÇ    ‚îÇ ‚Ä¢ Dashboard     ‚îÇ
‚îÇ ‚Ä¢ Real-time WS  ‚îÇ    ‚îÇ ‚Ä¢ REST API      ‚îÇ    ‚îÇ ‚Ä¢ Data storage  ‚îÇ
‚îÇ ‚Ä¢ PWA install   ‚îÇ    ‚îÇ ‚Ä¢ Heartbeat     ‚îÇ    ‚îÇ                 ‚îÇ
‚îÇ ‚Ä¢ Background    ‚îÇ    ‚îÇ ‚Ä¢ Auto tests    ‚îÇ    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚îÇ
                              ‚ñº
                       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                       ‚îÇ   Production    ‚îÇ
                       ‚îÇ   VPS Server    ‚îÇ
                       ‚îÇ ‚Ä¢ Ubuntu 22.04  ‚îÇ
                       ‚îÇ ‚Ä¢ Node.js 22.x  ‚îÇ
                       ‚îÇ ‚Ä¢ PM2 process   ‚îÇ
                       ‚îÇ ‚Ä¢ Nginx proxy   ‚îÇ
                       ‚îÇ ‚Ä¢ SSL certs     ‚îÇ
                       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Heartbeat –º–µ—Ö–∞–Ω–∏–∑–º (ping-pong):**
- –°–µ—Ä–≤–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `ping` –∫–∞–∂–¥—ã–µ 20 —Å–µ–∫—É–Ω–¥ –≤—Å–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º
- –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –æ—Ç–≤–µ—á–∞–µ—Ç `pong` –≤ —Ç–µ—á–µ–Ω–∏–µ 10 —Å–µ–∫—É–Ω–¥
- –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –æ—Ç–≤–µ—Ç–∞ ‚Üí `connection_lost` –Ω–∞ `/webhook/connection`
- –ü—Ä–∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ ‚Üí `connection_restored` –Ω–∞ `/webhook/connection`

## ‚úÖ –°–ò–°–¢–ï–ú–ê –ì–û–¢–û–í–ê –ò –†–ê–ë–û–¢–ê–ï–¢!

### üü¢ –°—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | URL/Details |
|-----------|--------|-------------|
| **PWA Client** | ‚úÖ **–†–∞–±–æ—Ç–∞–µ—Ç** | https://artemtech007.github.io/internet-monitor-pwa/ |
| **WebSocket Server** | ‚úÖ **–û–Ω–ª–∞–π–Ω** | wss://befiebubopal.beget.app/ws |
| **REST API** | ‚úÖ **–î–æ—Å—Ç—É–ø–µ–Ω** | https://befiebubopal.beget.app/api/devices |
| **N8N Webhooks** | ‚úÖ **–ê–∫—Ç–∏–≤–Ω—ã** | https://botstroikom.store/webhook/* |
| **SSL –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç** | ‚úÖ **–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω** | Let's Encrypt –¥–æ –º–∞—Ä—Ç–∞ 2026 |

### üéØ –ß–¢–û –†–ê–ë–û–¢–ê–ï–¢:

#### ‚úÖ **PWA –Ω–∞ Android (Chrome):**
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ –º–µ–Ω—é –±—Ä–∞—É–∑–µ—Ä–∞ ‚úÖ
- –ê–≤—Ç–æ–Ω–æ–º–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚úÖ
- –§–æ–Ω–æ–≤—ã–µ —Ç–µ—Å—Ç—ã –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω ‚úÖ
- WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ ‚úÖ
- –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ N8N ‚úÖ

#### ‚úÖ **–°–µ—Ä–≤–µ—Ä:**
- WebSocket —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω ‚úÖ
- Heartbeat –º–µ—Ö–∞–Ω–∏–∑–º (ping-pong) ‚úÖ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è ‚úÖ
- PM2 –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ ‚úÖ
- Nginx –ø—Ä–æ–∫—Å–∏ ‚úÖ
- SSL —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ ‚úÖ

#### ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
- N8N –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ ‚úÖ
- –†–µ–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å–∫–æ—Ä–æ—Å—Ç–∏ ‚úÖ
- –¢–æ–∫–µ–Ω –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è ‚úÖ

### ‚ö†Ô∏è –û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø ANDROID PWA:

#### üì± **–†–∞–±–æ—Ç–∞–µ—Ç:**
- **–°–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Recent Apps** = —Ñ–æ–Ω–æ–≤–∞—è —Ä–∞–±–æ—Ç–∞ (—Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ Doze mode)
- **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —ç–∫—Ä–∞–Ω–∞** = —Ç–µ—Å—Ç—ã –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç—Å—è (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ)
- **–†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞** = —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

#### üö´ **–ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- **–°–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫** = –ø–æ–ª–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ PWA
- **Firefox –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ** = Service Worker –æ—Ç–∫–ª—é—á–µ–Ω
- **Chrome –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ** = –≤—ã–∑—ã–≤–∞–µ—Ç –ø–∞–¥–µ–Ω–∏–µ –±—Ä–∞—É–∑–µ—Ä–∞
- **iOS Safari** = –Ω–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–æ—Å—å

#### üìä **–ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- **–°—Ç–∞—Ç—É—Å—ã —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è** = –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ webhook –ø—Ä–∏ —Ä–∞–∑—Ä—ã–≤–∞—Ö/–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è—Ö
- **–°–∞–º–æ–æ—á–∏—â–µ–Ω–∏–µ –ª–æ–≥–æ–≤** = —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 200 –∑–∞–ø–∏—Å–µ–π
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** = –æ —Å–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–∏ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏
- –ß–µ—Ä–µ–∑ –º–µ–Ω—é –±—Ä–∞—É–∑–µ—Ä–∞ ‚Üí "–î–æ–±–∞–≤–∏—Ç—å –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω"
- –ö–Ω–æ–ø–∫–∞ "üì± –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å PWA" –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

### üì± –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ PWA

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
   ```
   https://artemtech007.github.io/internet-monitor-pwa/
   ```

2. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É:**
   - –í–≤–µ–¥–∏—Ç–µ —Ç–æ–∫–µ–Ω: `PHONE001`, `PHONE002`, –∏–ª–∏ `PHONE003`
   - –ù–∞–∂–º–∏—Ç–µ "üîå –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è"

3. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
   - **Android (Chrome):** –ù–∞–∂–º–∏—Ç–µ "üì± –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å PWA" ‚Üí —Å–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º
   - **Firefox:** –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ (–±–µ–∑ PWA —É—Å—Ç–∞–Ω–æ–≤–∫–∏)
   - **Chrome –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ:** –ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å (–≤—ã–∑—ã–≤–∞–µ—Ç –ø–∞–¥–µ–Ω–∏–µ –±—Ä–∞—É–∑–µ—Ä–∞)

4. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏:**
   - –ù–∞–∂–º–∏—Ç–µ "‚ö° –¢–µ—Å—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏"
   - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

### üñ•Ô∏è –°–µ—Ä–≤–µ—Ä (—É–∂–µ –∑–∞–ø—É—â–µ–Ω)

**–¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
- **VPS:** 155.212.220.59
- **–û–°:** Ubuntu 22.04
- **Node.js:** v22.21.0
- **–ü—Ä–æ—Ü–µ—Å—Å—ã:** PM2 (internet-monitor-ws)
- **SSL:** Let's Encrypt (befiebubopal.beget.app)
- **Nginx:** –ü—Ä–æ–∫—Å–∏ –¥–ª—è WebSocket –∏ HTTP

**–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ä–≤–µ—Ä–∞:**
```bash
# –°—Ç–∞—Ç—É—Å –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
ssh root@155.212.220.59 'pm2 list'

# –õ–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞
ssh root@155.212.220.59 'pm2 logs internet-monitor-ws --lines 10'

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤
ssh root@155.212.220.59 'netstat -tlnp | grep :808'
```
npm start
# –ò–ª–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏: npm run dev
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤

```javascript
// –í app.js –∏–∑–º–µ–Ω–∏—Ç—å
serverUrl: 'wss://your-server.com/ws'

// –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–∫–µ–Ω—ã –≤ VALID_TOKENS
const VALID_TOKENS = [
    'YOUR_PHONE_TOKEN',
    'ANOTHER_DEVICE_TOKEN'
];
```

## üì° API –∏ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è

### üîå WebSocket –ø—Ä–æ—Ç–æ–∫–æ–ª

**–°–µ—Ä–≤–µ—Ä:** `wss://befiebubopal.beget.app/ws`

#### –°–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É:
- `auth` - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
  ```json
  {
    "type": "auth",
    "token": "PHONE001",
    "deviceId": "device_123"
  }
  ```
- `speed_result` - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏
- `pong` - –û—Ç–≤–µ—Ç –Ω–∞ heartbeat ping
  ```json
  {
    "type": "speed_result",
    "speedMbps": 15.7,
    "bytesSent": 50000,
    "bytesReceived": 50000,
    "duration": 2450,
    "success": true,
    "timestamp": 1765487007,
    "deviceId": "device_123",
    "token": "PHONE001"
  }
  ```

#### –°–æ–æ–±—â–µ–Ω–∏—è –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –∫ –∫–ª–∏–µ–Ω—Ç—É:
- `auth_success` - –£—Å–ø–µ—à–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- `speed_test_request` - –ó–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–∞
- `ping` - Heartbeat –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- `welcome` - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- `error` - –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏

### üåê HTTP REST API

**–ë–∞–∑–æ–≤—ã–π URL:** `https://befiebubopal.beget.app/api`

- `GET /api/devices` - –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
  ```json
  [
    {
      "deviceId": "device_123",
      "token": "PHONE001",
      "lastSeen": 1765487007,
      "connected": true
    }
  ]
  ```

### üìä N8N Webhook –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

**–°–∏—Å—Ç–µ–º–∞ –∏–∑ 4 –≤–µ–±—Ö—É–∫–æ–≤:**
- `/webhook/speed` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤ —Å–∫–æ—Ä–æ—Å—Ç–∏
- `/webhook/connection` - —Å—Ç–∞—Ç—É—Å—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (lost/restored)
- `/webhook/lifecycle` - –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (background/foreground/closed)

**–ë–∞–∑–æ–≤—ã–π URL:** `https://botstroikom.store`

**–§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö (GET –ø–∞—Ä–∞–º–µ—Ç—Ä—ã):**
```
type=speed_result&speedMbps=15.7&bytesSent=50000&bytesReceived=50000&duration=2450&success=true&timestamp=1765487007&deviceId=device_123&token=PHONE001
```

**Heartbeat –º–µ—Ö–∞–Ω–∏–∑–º (ping-pong):**
- –°–µ—Ä–≤–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `ping` –∫–∞–∂–¥—ã–µ 20 —Å–µ–∫—É–Ω–¥
- –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –æ—Ç–≤–µ—á–∞–µ—Ç `pong` –≤ —Ç–µ—á–µ–Ω–∏–µ 10 —Å–µ–∫—É–Ω–¥
- –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –æ—Ç–≤–µ—Ç–∞ ‚Üí `connection_lost`
- –ü—Ä–∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ ‚Üí `connection_restored`

**–ü—Ä–∏–º–µ—Ä –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤ N8N:**
```javascript
// –í Function Node
const query = $node["Webhook"].query;

return {
  speed: parseFloat(query.speedMbps),
  device: query.deviceId,
  timestamp: new Date(parseInt(query.timestamp) * 1000),
  success: query.success === 'true'
};
```
    deviceId: 'device_123',
    token: 'PHONE001'
}));

// –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞
ws.onmessage = (event) => {
    const data = JSON.parse(event.data);
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥
};
```

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

### –ü—Ä–æ—Å—Ç–∞—è —Ç–æ–∫–µ–Ω-—Å–∏—Å—Ç–µ–º–∞

```javascript
// –ù–∞ –∫–ª–∏–µ–Ω—Ç–µ
const validTokens = ['PHONE001', 'PHONE002', 'PHONE003'];

function checkAccess() {
    const token = prompt('–ö–æ–¥ –¥–æ—Å—Ç—É–ø–∞:');
    return validTokens.includes(token);
}
```

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

```javascript
// JWT —Ç–æ–∫–µ–Ω—ã
// –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
// OAuth –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
```

## ‚ö° –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### 1. Stream Processing (—ç–∫–æ–Ω–æ–º–∏—Ç –ø–∞–º—è—Ç—å)

```javascript
// –í–º–µ—Å—Ç–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–∞
const reader = response.body.getReader();
let bytesReceived = 0;

while (true) {
    const { done, value } = await reader.read();
    if (done) break;
    bytesReceived += value.length; // –¢–æ–ª—å–∫–æ —Å—á–µ—Ç—á–∏–∫!
}
```

### 2. WebSocket –≤–º–µ—Å—Ç–æ polling

```javascript
// Push –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
// –°–µ—Ä–≤–µ—Ä —Å–∞–º –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç —Ç–µ—Å—Ç—ã
ws.send(JSON.stringify({
    type: 'speed_test_request',
    fileSize: 50000
}));
```

### 3. Service Worker –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

```javascript
// –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
self.addEventListener('install', event => {
    event.waitUntil(
        caches.open('v1').then(cache => {
            return cache.addAll([
                '/', '/index.html', '/app.js'
            ]);
        })
    );
});
```

## üñ•Ô∏è –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

### VPS —Å Docker

```dockerfile
# Dockerfile
FROM node:18-alpine
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production
COPY . .
EXPOSE 8080 8081
CMD ["npm", "start"]
```

```bash
# –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
docker build -t internet-monitor .
docker run -d -p 8080:8080 -p 8081:8081 internet-monitor
```

### –° systemd

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞
sudo nano /etc/systemd/system/internet-monitor.service

[Unit]
Description=Internet Monitor WebSocket Server
After=network.target

[Service]
Type=simple
User=ubuntu
WorkingDirectory=/home/ubuntu/internet-monitor/server_websocket
ExecStart=/usr/bin/node server.js
Restart=always

[Install]
WantedBy=multi-user.target

# –ó–∞–ø—É—Å–∫
sudo systemctl enable internet-monitor
sudo systemctl start internet-monitor
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

### üü¢ –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | URL/–ö–æ–º–∞–Ω–¥–∞ |
|-----------|--------|-------------|
| **PWA Client** | ‚úÖ –û–Ω–ª–∞–π–Ω | https://artemtech007.github.io/internet-monitor-pwa/ |
| **WebSocket Server** | ‚úÖ –û–Ω–ª–∞–π–Ω | `pm2 list` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ |
| **HTTP API** | ‚úÖ –û–Ω–ª–∞–π–Ω | https://befiebubopal.beget.app/api/devices |
| **N8N Webhook** | ‚úÖ –ê–∫—Ç–∏–≤–µ–Ω | https://botstroikom.store/webhook/ph1 |
| **SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç** | ‚úÖ –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω | Let's Encrypt –¥–æ –º–∞—Ä—Ç–∞ 2026 |

### üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

#### –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:
```bash
# 1. WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
node -e "
const WebSocket = require('ws');
const ws = new WebSocket('wss://befiebubopal.beget.app/ws');
ws.on('open', () => { console.log('‚úÖ WS: OK'); ws.close(); });
ws.on('error', (e) => console.log('‚ùå WS:', e.message));
setTimeout(() => ws.close(), 3000);
"

# 2. HTTP API
curl -s https://befiebubopal.beget.app/api/devices && echo "‚úÖ API: OK"

# 3. N8N Webhook
curl -s "https://botstroikom.store/webhook/ph1?test=health&timestamp=$(date +%s)" && echo "‚úÖ Webhook: OK"
```

#### –î–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞:
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
ssh root@155.212.220.59 'pm2 logs internet-monitor-ws --lines 20'

# –°—Ç–∞—Ç—É—Å –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
ssh root@155.212.220.59 'pm2 list'

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤
ssh root@155.212.220.59 'netstat -tlnp | grep :808'
```

### üö® –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π

#### PWA –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è:
```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:
console.log('PWA Status:');
console.log('Service Worker:', !!navigator.serviceWorker);
console.log('WebSocket:', !!window.WebSocket);
console.log('Manifest:', !!document.querySelector('link[rel=manifest]'));
```

#### WebSocket –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è:
```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:
pm2 describe internet-monitor-ws
netstat -tlnp | grep :8081
tail -f /var/log/nginx/error.log
```

#### N8N –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å webhook URL
ssh root@155.212.220.59 'grep N8N_WEBHOOK_URL ~/internet-monitor-websocket/server.js'

# –†—É—á–Ω–æ–π —Ç–µ—Å—Ç
curl -X GET "https://botstroikom.store/webhook/ph1?test=manual&speed=12.5"
```
curl -X POST http://localhost:8080/api/broadcast \
  -H "Content-Type: application/json" \
  -d '{"type": "ping_test_request"}'
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# .env —Ñ–∞–π–ª
PORT=8080
WS_PORT=8081
N8N_WEBHOOK_URL=https://botstroikom.store/webhook/ph1
WS_SERVER_URL=wss://your-domain.com/ws
NODE_ENV=production
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤

```javascript
// –í app.js
const settings = {
    serverUrl: 'wss://your-domain.com/ws',
    testFileSize: 50000, // –±–∞–π—Ç—ã
    reconnectInterval: 5000, // –º—Å
    validTokens: ['PHONE001', 'PHONE002']
};
```

## üö® –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### WebSocket –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

```javascript
ws.onclose = () => {
    console.log('–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä—è–Ω–æ, –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...');
    setTimeout(() => connect(), 5000);
};
```

### Fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤

```javascript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏
if (!('WebSocket' in window)) {
    alert('–í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç WebSocket');
    // Fallback –Ω–∞ HTTP polling
}
```

## üìà –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

### –î–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤

1. **Redis** –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–π —É—Å—Ç—Ä–æ–π—Å—Ç–≤
2. **–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è** WebSocket —Å–µ—Ä–≤–µ—Ä–∞
3. **–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏**
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** —Å Prometheus/Grafana

### –î–ª—è –≤—ã—Å–æ–∫–∏—Ö –Ω–∞–≥—Ä—É–∑–æ–∫

1. **CDN** –¥–ª—è PWA —Ñ–∞–π–ª–æ–≤
2. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ç–µ—Å—Ç–æ–≤
3. **–û—á–µ—Ä–µ–¥–∏** –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–º–∞–Ω–¥
4. **Rate limiting** –Ω–∞ API

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –¢–µ—Å—Ç PWA –ª–æ–∫–∞–ª—å–Ω–æ
cd pwa
python3 -m http.server 8000
# –û—Ç–∫—Ä—ã—Ç—å http://localhost:8000

# –¢–µ—Å—Ç —Å–µ—Ä–≤–µ—Ä–∞
cd server_websocket
npm test

# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
npm run test:e2e
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [üöÄ –ü–æ–ª–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã](docs/comprehensive_installation_guide.md) - **–ì–õ–ê–í–ù–´–ô –ì–ê–ô–î**
- [üì± –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PWA](docs/pwa_installation.md) - –¢–æ–ª—å–∫–æ –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- [üñ•Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞](docs/server_setup_guide.md) - VPS —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
- [üîç –ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫](docs/javascript_error_analysis.md) - –û—Ç–ª–∞–¥–∫–∞ JavaScript
- [üì° API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](server_websocket/README.md) - WebSocket –∏ REST API

## üéØ Production Checklist

- [ ] HTTPS –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] –¢–æ–∫–µ–Ω—ã –¥–æ—Å—Ç—É–ø–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] Backup —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –≥–æ—Ç–æ–≤–∞
- [ ] Rate limiting –≤–∫–ª—é—á–µ–Ω
- [ ] SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã
- [ ] Firewall –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞

---

## üéâ –ü—Ä–æ–µ–∫—Ç –∑–∞–≤–µ—Ä—à–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç!

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:

- ‚úÖ **PWA –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** - –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –Ω–∞ GitHub Pages
- ‚úÖ **WebSocket —Å–µ—Ä–≤–µ—Ä** - –ó–∞–ø—É—â–µ–Ω –Ω–∞ VPS —Å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–æ–º
- ‚úÖ **SSL —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ** - Let's Encrypt —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
- ‚úÖ **N8N –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - Webhook –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∫–æ—Ä–æ—Å—Ç–∏** - –†–µ–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –≤ Mbps
- ‚úÖ **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** - –¢–æ–∫–µ–Ω—ã –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚úÖ **Heartbeat –º–µ—Ö–∞–Ω–∏–∑–º** - –ù–∞–¥–µ–∂–Ω–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä–∏ —Å–≤—è–∑–∏
- ‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### üåü –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:

- üöÄ **–ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞** - PWA —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ä–∞–∑—É
- üîí **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - WSS + —Ç–æ–∫–µ–Ω—ã + HTTPS
- üìä **–†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** - –ò–∑–º–µ—Ä–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
- üì± **–ö—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ—Å—Ç—å** - –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
- ‚ö° **Real-time** - WebSocket –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–π —Å–≤—è–∑–∏
- üîÑ **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** - –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã –∫–∞–∂–¥—ã–µ 20 —Å–µ–∫—É–Ω–¥

### üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ —Ä–∞–∑–≤–∏—Ç–∏–µ:

- üìã **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - –í—Å–µ —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫–µ `docs/`
- üîß **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞
- üêõ **–û—Ç–ª–∞–¥–∫–∞** - –î–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
- üöÄ **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ** - –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏

**–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üéØ**
